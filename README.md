

# URL Shortener üîó

A lightweight and efficient **URL shortening service** built with **FastAPI** and **MongoDB**.
This project enables users to convert long URLs into short, shareable links with ease.



## üìã Table of Contents

* [Features](#-features)
* [Setup Guidelines](#-setup-guidelines)
* [Prerequisites](#-prerequisites)
* [Getting Started](#-getting-started)
* [Setting Up Environment Variables](#Ô∏è-setting-up-environment-variables)
* [Running the Project](#-running-the-project)
* [How It Works](#-how-it-works)




## ‚ú® Features

* **URL Shortening**: Convert long URLs into unique, short codes.
* **Database Integration**: Store shortened links and their corresponding original URLs in a **MongoDB** database.
* **FastAPI**: Built with a modern, high-performance Python web framework.
* **Environment Variables**: Securely manage database credentials and other sensitive information.

---

## ‚öôÔ∏è Setup Guidelines

### üìã Prerequisites

Before setting up the project, ensure the following are installed on your local machine:

* **Python 3.8+**
* **Git**

---

### üöÄ Getting Started

#### 1. Clone the Repository

```bash
git clone https://github.com/snahanku/url_shortner.git
cd url_shortner
```
---

#### 2. Create a Python Virtual Environment

It is recommended to use a virtual environment to manage project dependencies:

```bash
python -m venv .venv
```

---

#### 3. Activate the Virtual Environment

* **On Windows:**

  ```bash
  .venv\Scripts\activate
  ```

* **On macOS/Linux:**

  ```bash
  source .venv/bin/activate
  ```

---

#### 4. Install Dependencies

All required libraries are listed in `requirements.txt`:

```bash
pip install -r requirements.txt
```





## ‚öôÔ∏è Setting Up Environment Variables

This project uses environment variables to securely connect to a MongoDB database.

1. Create a `.env` file in the root of your project.
2. Add your MongoDB Atlas connection string under the key `MONGO_URI`.

```env
MONGO_URI=mongodb+srv://<username>:<password>@<cluster-name>.mongodb.net/<app-name>?retryWrites=true&w=majority
```

> **Note:** Replace `<username>`, `<password>`, `<cluster-name>`, and `<app-name>` with your actual MongoDB credentials.
> Never hardcode these values directly into your code.

---

## üöÄ Running the Project

Once environment variables are configured, start the application with **Uvicorn**:

```bash
uvicorn main:app --reload
```

The API will be available at:
üëâ `http://127.0.0.1:8000` [for local machine]




## üåç Hosted Version

The project is also deployed on Render:

üîó Link:   https://url-shortner-web-service.onrender.com

Example interface: <img width="1919" height="214" alt="image" src="https://github.com/user-attachments/assets/4a79be9a-e53a-44d6-b269-684538923536" />

> **Note on Render Hosting (Free Tier):**
>
> * The service may enter an idle state after inactivity.
> * When accessed after some time, it may display a **‚ÄúWaking up‚Äù** message or take longer to respond.
> * This behavior is expected for free-tier deployments.
> * More details: [Render Community Discussion](https://community.render.com/t/web-service-not-waking-up-after-inactivity-period/12165/7).

---

Would you like me to also **add a `requirements.txt` installation step** before the "Running the Project" section so GitHub readers can directly set up dependencies?

## üí° How It Works

1. The **`/short`** endpoint accepts a JSON body containing a long URL.
2. The service generates a `short_id` and stores it along with the `original_url` and additional metadata in a **MongoDB collection**.
3. When a user visits a shortened URL (e.g., `https://url-shortner-web-service.onrender.com/{short_id}`), the application looks up the `short_id` in the database and redirects to the original URL.
4. For scraping, users can navigate to `https://url-shortner-web-service.onrender.com/scrape/{short_id}`, replacing `short_id` with the value generated by the `/short` endpoint. This returns the associated metadata in JSON format.





### API Endpoints Overview

TH endpoints 

<img width="1814" height="546" alt="image" src="https://github.com/user-attachments/assets/53543f16-41a8-4767-89bf-4ef8131ea5c3" />



0. **`/`**

   * Test endpoint.
   * Returns a message indicating the application home.

1. **`/short`**

   * Shortens a given long URL.
   * Accepts the URL as a query parameter.

2. **`/{short_code}`**

   * Redirects to the original URL associated with the provided `{short_code}`.
   * The `{short_code}` is generated via the `/short` endpoint (e.g., `"J04OwQM"`).

3. **`/data`**

   * Retrieves data stored in the database.
   * Primarily used for testing and debugging purposes.

4. **`/scrape/{short_code}`**

   * Returns metadata in JSON format for the provided `{short_code}`.
   * The JSON response includes fields such as:

     * `short_url`
     * `long_url`
     * `first_click`
     * `last_click`
     * `short_code`




### Additional Features

**Analytics: First and Last Click Tracking**

An analytics feature has been implemented to record the **first click** and **last click** for each shortened URL.

This functionality is designed using a **decorator pattern**, making it reusable across multiple endpoints. While primarily applied to shortened URLs, it can also be extended to the scraping endpoint (or others, if required). Each time a user accesses the link, the decorator ensures that both the first and most recent clicks are captured and stored.

The stored data includes **human-readable timestamps**, which are persisted in the database for reference.

**Implementation Overview:**

* The decorator wraps the target endpoint.
* On each request, it checks and records the first click if not already stored.
* The last click timestamp is updated with every access.

Below are glimpses of the implementation:

üìå **Decorator Implementation Example**

  <img width="630" height="478" alt="image" src="https://github.com/user-attachments/assets/7f45ea29-0f4d-40f0-b435-49b6ea98bd4b" />

üìå first click & last click data  for instance 

   <img width="947" height="103" alt="image" src="https://github.com/user-attachments/assets/d427bcf3-2ab9-4ce4-a419-df8d61c1b7c9" />



Here‚Äôs a **refined, professional, and GitHub-ready version** of your text:

---

### üî¨ Testing Endpoints with Postman

#### 1. **`/short` Endpoint**

* **URL:** `https://url-shortner-web-service.onrender.com/short`
* **Method:** `POST`
* **Body (raw JSON):**

  ```json
  {
    "url": "string"
  }
  ```
* Ensure **raw** is selected and **JSON** is chosen from the dropdown.
* Required parameters should also be passed in headers (as configured earlier).

**Request Example:** <img width="1470" height="350" alt="image" src="https://github.com/user-attachments/assets/327837c3-20d7-4a96-b2c3-14bc538539b3" />

**Response:** <img width="1489" height="686" alt="image" src="https://github.com/user-attachments/assets/560eb24c-001f-4023-8dc1-eb1d3562f325" />

> The generated short link can be opened directly in a browser, which redirects to the original long URL.

---

#### 2. **`/{short_code}` Endpoint**

* **URL:** `https://url-shortner-web-service.onrender.com/{short_code}`
* `{short_code}` is the unique identifier appended after `/` in the shortened URL (e.g., `J04OwQM`).
* **Method:** `GET`

**Example:** <img width="62" height="24" alt="image" src="https://github.com/user-attachments/assets/2485a452-b9c2-417c-b0f0-281ad32f6b01" />

**Response:** <img width="1465" height="819" alt="image" src="https://github.com/user-attachments/assets/fb50c7fa-12ac-4b43-bc69-3725f73b98ef" />

> Hitting the shortened URL in a browser also redirects correctly to the original long URL.

---

#### 3. **`/scrape/{short_code}` Endpoint**

* **URL:** `https://url-shortner-web-service.onrender.com/scrape/{short_code}`
* `{short_code}` is the identifier from the shortened URL.
* **Method:** `GET`
* Returns metadata in JSON format (short URL, long URL, first click, last click, short\_code).

**Response:** <img width="1538" height="709" alt="image" src="https://github.com/user-attachments/assets/6363e699-54f3-435a-ae63-102ea97d7b40" />

---

#### 4. **`/data` Endpoint**

* **URL:** `https://url-shortner-web-service.onrender.com/data`
* **Method:** `GET`
* Used to view data stored in the database (primarily for debugging/testing).

**Response:** <img width="1487" height="793" alt="image" src="https://github.com/user-attachments/assets/53da306c-299b-4f91-a541-13d6bdd087ed" />



Lastly , I am providing the video link to understand it end to end , hope it helps  :)

link : https://drive.google.com/drive/folders/11U7mUnziP53bmdzY2wdb5GUxhzCfMSff?q=sharedwith:public%20parent:11U7mUnziP53bmdzY2wdb5GUxhzCfMSff



    
   

   



       





     


    


          



